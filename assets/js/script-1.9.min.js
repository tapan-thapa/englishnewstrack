$(document).ready(function() {
    $("#featured-slider").slick({
        autoplay: false,
        autoplaySpeed: 4900,
        slidesToShow: 1,
        slidesToScroll: 1,
        infinite: false,
        speed: 200,
        swipeToSlide: true,
        cssEase: "linear",
        lazyLoad: "progressive",
        prevArrow: $("#featured-slider-nav .prev"),
        nextArrow: $("#featured-slider-nav .next"),
    }); 
    $('.carousel4img').slick({
        speed: 500,
        slidesToShow: 4,
        slidesToScroll: 1,
        autoplaySpeed: 2000,
        dots:false,
        prevArrow: $("#featured-slider-nav .prev"),
        nextArrow: $("#featured-slider-nav .next"),
        responsive: [{
        breakpoint: 1024,
        settings: {
        slidesToShow:4, 
        slidesToScroll: 1,
           }
    
        }, {
          breakpoint: 800,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2,    
          }
        },  {
          breakpoint: 480,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1,
            autoplaySpeed: 2000,
          }
        }]
      });
    $("#random-slider").slick({
        autoplay: true,
        autoplaySpeed: 4900,
        slidesToShow: 4,
        slidesToScroll: 1,
        infinite: true,
        speed: 200,
        rtl: rtl,
        lazyLoad: "progressive",
        prevArrow: $("#random-slider-nav .prev"),
        nextArrow: $("#random-slider-nav .next"),
    });
    $("#post-detail-slider").slick({
        autoplay: false,
        autoplaySpeed: 4900,
        slidesToShow: 1,
        slidesToScroll: 1,
        infinite: false,
        speed: 200,
        rtl: rtl,
        adaptiveHeight: true,
        cssEase: "linear",
        lazyLoad: "progressive",
        prevArrow: $("#post-detail-slider-nav .prev"),
        nextArrow: $("#post-detail-slider-nav .next"),
    });
    $(".main-menu .dropdown").hover(function() {
        $(".li-sub-category").removeClass("active");
        $(".sub-menu-inner").removeClass("active");
        $(".sub-menu-right .filter-all").addClass("active")
    }, function() {});
    $(".main-menu .navbar-nav .dropdown-menu").hover(function() {
        var b = $(this).attr("data-mega-ul");
        if (b != undefined) {
            $(".main-menu .navbar-nav .dropdown").removeClass("active");
            $(".mega-li-" + b).addClass("active")
        }
    }, function() {
        $(".main-menu .navbar-nav .dropdown").removeClass("active")
    });
    $(".li-sub-category").hover(function() {
        var b = $(this).attr("data-category-filter");
        $(".li-sub-category").removeClass("active");
        $(this).addClass("active");
        $(".sub-menu-right .sub-menu-inner").removeClass("active");
        $(".sub-menu-right .filter-" + b).addClass("active")
    }, function() {});
    $(".news-ticker ul li").delay(500).fadeIn(100);
    $(".newsticker").newsTicker({
        row_height: 30,
        max_rows: 1,
        speed: 400,
        direction: "up",
        duration: 4000,
        autostart: 1,
        pauseOnHover: 0,
        prevButton: $("#btn_newsticker_prev"),
        nextButton: $("#btn_newsticker_next")
    });
    $(window).scroll(function() {
        if ($(this).scrollTop() > 100) {
            $(".scrollup").fadeIn()
        } else {
            $(".scrollup").fadeOut()
        }
    });
    $(".scrollup").click(function() {
        $("html, body").animate({
            scrollTop: 0
        }, 700);
        return false
    });
    $("form").submit(function() {
        $("input[name='" + csfr_token_name + "']").val($.cookie(csfr_cookie_name))
    });
    $(document).ready(function() {
        $('[data-toggle-tool="tooltip"]').tooltip()
    })
});
$("#form_validate").validate();
$("#search_validate").validate();
$(document).on("click", ".btn-open-mobile-nav", function() {
    if ($("#navMobile").hasClass("nav-mobile-open")){
        $("#navMobile").removeClass("nav-mobile-open");
        //$(".btn-open-mobile-nav i").removeClass("icon-menu");
       // $(".btn-open-mobile-nav i").addClass("icon-times"); 
        $("#overlay_bg").hide()
    } else {
        $("#navMobile").addClass("nav-mobile-open");
        //$(".btn-open-mobile-nav i").removeClass("icon-times");
        //$(".btn-open-mobile-nav i").addClass("icon-menu");
        $("#overlay_bg").show()
    }
});

$(document).on("click", "#overlay_bg", function() {
    $("#navMobile").removeClass("nav-mobile-open");
    $("#overlay_bg").hide()
});
$(".close-menu-click").click(function() {
    $("#navMobile").removeClass("nav-mobile-open");
    $("#overlay_bg").hide()
});
$(window).on("load", function() {
    $(".show-on-page-load").css("visibility", "visible")
});
$(document).ready(function() {
    $("iframe").attr("allowfullscreen", "")
});
var custom_scrollbar = $(".custom-scrollbar");
if (custom_scrollbar.length) {
    var ps = new PerfectScrollbar(".custom-scrollbar", {
        wheelPropagation: true,
        suppressScrollX: true
    })
}
var custom_scrollbar = $(".custom-scrollbar-followers");
if (custom_scrollbar.length) {
    var ps = new PerfectScrollbar(".custom-scrollbar-followers", {
        wheelPropagation: true,
        suppressScrollX: true
    })
}
$(".search-icon").click(function() {
    if ($(".search-form").hasClass("open")) {
        $(".search-form").removeClass("open");
        $(".search-icon i").removeClass("icon-times");
        $(".search-icon i").addClass("icon-search")
    } else {
        $(".search-form").addClass("open");
        $(".search-icon i").removeClass("icon-search");
        $(".search-icon i").addClass("icon-times")
    }
});
$(document).ready(function() {
    $("#form-login").submit(function(a) {
        a.preventDefault();
        var b = $(this);
        var c = b.serializeArray();
        c.push({
            name: csfr_token_name,
            value: $.cookie(csfr_cookie_name)
        });
        $.ajax({
            url: base_url + "auth_controller/login_post",
            type: "post",
            data: c,
            success: function(e) {
                var d = JSON.parse(e);
                if (d.result == 1) {
                    location.reload()
                } else {
                    if (d.result == 0) {
                        document.getElementById("result-login").innerHTML = d.error_message
                    }
                }
            }
        })
    })
});

function add_reaction(b, c) {
    var a = {
        post_id: b,
        reaction: c,
        sys_lang_id: sys_lang_id
    };
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        method: "POST",
        url: base_url + "home_controller/save_reaction",
        data: a
    }).done(function(d) {
        document.getElementById("reactions_result").innerHTML = d
    })
}
$(document).ready(function() {
    $("#make_comment_registered").submit(function(b) {
        b.preventDefault();
        var c = $(this).serializeArray();
        var a = {
            sys_lang_id: sys_lang_id
        };
        var d = true;
        $(c).each(function(f, e) {
            if ($.trim(e.value).length < 1) {
                $("#make_comment_registered [name='" + e.name + "']").addClass("is-invalid");
                d = false
            } else {
                $("#make_comment_registered [name='" + e.name + "']").removeClass("is-invalid");
                a[e.name] = e.value
            }
        });
        a.limit = $("#post_comment_limit").val();
        a[csfr_token_name] = $.cookie(csfr_cookie_name);
        if (d == true) {
            $.ajax({
                type: "POST",
                url: base_url + "home_controller/add_comment_post",
                data: a,
                success: function(f) {
                    var e = JSON.parse(f);
                    if (e.type == "message") {
                        document.getElementById("message-comment-result").innerHTML = e.message
                    } else {
                        document.getElementById("comment-result").innerHTML = e.message
                    }
                    $("#make_comment_registered")[0].reset()
                }
            })
        }
    });
    $("#make_comment").submit(function(b) {
        b.preventDefault();
        var c = $(this).serializeArray();
        var a = {
            sys_lang_id: sys_lang_id
        };
        var d = true;
        $(c).each(function(f, e) {
            if ($.trim(e.value).length < 1) {
                $("#make_comment [name='" + e.name + "']").addClass("is-invalid");
                d = false
            } else {
                $("#make_comment [name='" + e.name + "']").removeClass("is-invalid");
                a[e.name] = e.value
            }
        });
        a.limit = $("#post_comment_limit").val();
        a[csfr_token_name] = $.cookie(csfr_cookie_name);
        if (is_recaptcha_enabled == true) {
            if (typeof a["g-recaptcha-response"] === "undefined") {
                $(".g-recaptcha").addClass("is-recaptcha-invalid");
                d = false
            } else {
                $(".g-recaptcha").removeClass("is-recaptcha-invalid")
            }
        }
        if (d == true) {
            $(".g-recaptcha").removeClass("is-recaptcha-invalid");
            $.ajax({
                type: "POST",
                url: base_url + "home_controller/add_comment_post",
                data: a,
                success: function(f) {
                    var e = JSON.parse(f);
                    if (e.type == "message") {
                        document.getElementById("message-comment-result").innerHTML = e.message
                    } else {
                        document.getElementById("comment-result").innerHTML = e.message
                    }
                    if (is_recaptcha_enabled == true) {
                        grecaptcha.reset()
                    }
                    $("#make_comment")[0].reset()
                }
            })
        }
    })
});
$(document).on("click", ".btn-subcomment-registered", function() {
    var a = $(this).attr("data-comment-id");
    var b = {
        sys_lang_id: sys_lang_id
    };
    b[csfr_token_name] = $.cookie(csfr_cookie_name);
    $("#make_subcomment_registered_" + a).ajaxSubmit({
        beforeSubmit: function() {
            var d = $("#make_subcomment_registered_" + a).serializeArray();
            var c = $.trim(d[0].value);
            if (c.length < 1) {
                $(".form-comment-text").addClass("is-invalid");
                return false
            } else {
                $(".form-comment-text").removeClass("is-invalid")
            }
        },
        type: "POST",
        url: base_url + "home_controller/add_comment_post",
        data: b,
        success: function(d) {
            var c = JSON.parse(d);
            if (c.type == "message") {
                document.getElementById("message-subcomment-result-" + a).innerHTML = c.message
            } else {
                document.getElementById("comment-result").innerHTML = c.message
            }
            $(".visible-sub-comment form").empty()
        }
    })
});
$(document).on("click", ".btn-subcomment", function() {
    var a = $(this).attr("data-comment-id");
    var b = {
        sys_lang_id: sys_lang_id
    };
    b[csfr_token_name] = $.cookie(csfr_cookie_name);
    b.limit = $("#post_comment_limit").val();
    var c = "#make_subcomment_" + a;
    $(c).ajaxSubmit({
        beforeSubmit: function() {
            var d = $("#make_subcomment_" + a).serializeArray();
            var e = true;
            $(d).each(function(g, f) {
                if ($.trim(f.value).length < 1) {
                    $(c + " [name='" + f.name + "']").addClass("is-invalid");
                    e = false
                } else {
                    $(c + " [name='" + f.name + "']").removeClass("is-invalid");
                    b[f.name] = f.value
                }
            });
            if (is_recaptcha_enabled == true) {
                if (typeof b["g-recaptcha-response"] === "undefined") {
                    $(c + " .g-recaptcha").addClass("is-recaptcha-invalid");
                    e = false
                } else {
                    $(c + " .g-recaptcha").removeClass("is-recaptcha-invalid")
                }
            }
            if (e == false) {
                return false
            }
        },
        type: "POST",
        url: base_url + "home_controller/add_comment_post",
        data: b,
        success: function(e) {
            if (is_recaptcha_enabled == true) {
                grecaptcha.reset()
            }
            var d = JSON.parse(e);
            if (d.type == "message") {
                document.getElementById("message-subcomment-result-" + a).innerHTML = d.message
            } else {
                document.getElementById("comment-result").innerHTML = d.message
            }
            $(".visible-sub-comment form").empty()
        }
    })
});

function load_more_comment(c) {
    var b = parseInt($("#post_comment_limit").val());
    var a = {
        post_id: c,
        limit: b,
        sys_lang_id: sys_lang_id
    };
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $("#load_comment_spinner").show();
    $.ajax({
        type: "POST",
        url: base_url + "home_controller/load_more_comment",
        data: a,
        success: function(d) {
            setTimeout(function() {
                $("#load_comment_spinner").hide();
                var e = JSON.parse(d);
                if (e.result == 1) {
                    document.getElementById("comment-result").innerHTML = e.html_content
                }
            }, 1000)
        }
    })
}

function delete_comment(a, c, b) {
    swal({
        text: b,
        icon: "warning",
        buttons: [sweetalert_cancel, sweetalert_ok],
        dangerMode: true,
    }).then(function(f) {
        if (f) {
            var e = parseInt($("#post_comment_limit").val());
            var d = {
                id: a,
                post_id: c,
                limit: e,
                sys_lang_id: sys_lang_id
            };
            d[csfr_token_name] = $.cookie(csfr_cookie_name);
            $.ajax({
                type: "POST",
                url: base_url + "home_controller/delete_comment_post",
                data: d,
                success: function(h) {
                    var g = JSON.parse(h);
                    if (g.result == 1) {
                        document.getElementById("comment-result").innerHTML = g.html_content
                    }
                }
            })
        }
    })
}

function show_comment_box(a) {
    if ($("#sub_comment_form_" + a).html().length > 0) {
        $("#sub_comment_form_" + a).empty()
    } else {
        $(".visible-sub-comment").empty();
        var c = parseInt($("#post_comment_limit").val());
        var b = {
            comment_id: a,
            limit: c,
            sys_lang_id: sys_lang_id
        };
        b[csfr_token_name] = $.cookie(csfr_cookie_name);
        $.ajax({
            type: "POST",
            url: base_url + "home_controller/load_subcomment_box",
            data: b,
            success: function(d) {
                $("#sub_comment_form_" + a).append(d)
            }
        })
    }
}
$(document).on("click", ".btn-comment-like", function() {
    if ($(this).hasClass("comment-liked")) {
        $(this).removeClass("comment-liked")
    } else {
        $(this).addClass("comment-liked")
    }
    var a = $(this).attr("data-comment-id");
    var b = {
        comment_id: a,
        sys_lang_id: sys_lang_id
    };
    b[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "home_controller/like_comment_post",
        data: b,
        success: function(d) {
            var c = JSON.parse(d);
            if (c.result == 1) {
                document.getElementById("lbl_comment_like_count_" + a).innerHTML = c.like_count
            }
        }
    })
});

function view_poll_results(b) {
    $("#poll_" + b + " .question").hide();
    $("#poll_" + b + " .result").show()
}

function view_poll_options(b) {
    $("#poll_" + b + " .result").hide();
    $("#poll_" + b + " .question").show()
}
$(document).ready(function() {
    var b;
    $(".poll-form").submit(function(h) {
        h.preventDefault();
        if (b) {
            b.abort()
        }
        var a = $(this);
        var g = a.find("input, select, button, textarea");
        var j = a.serializeArray();
        j.push({
            name: csfr_token_name,
            value: $.cookie(csfr_cookie_name)
        });
        var i = $(this).attr("data-form-id");
        b = $.ajax({
            url: base_url + "home_controller/add_vote",
            type: "post",
            data: j,
        });
        b.done(function(c) {
            g.prop("disabled", false);
            if (c == "required") {
                $("#poll-required-message-" + i).show();
                $("#poll-error-message-" + i).hide()
            } else {
                if (c == "voted") {
                    $("#poll-required-message-" + i).hide();
                    $("#poll-error-message-" + i).show()
                } else {
                    document.getElementById("poll-results-" + i).innerHTML = c;
                    $("#poll_" + i + " .result").show();
                    $("#poll_" + i + " .question").hide()
                }
            }
        })
    })
});

function add_delete_from_reading_list(b) {
    $(".tooltip").hide();
    var a = {
        post_id: b,
    };
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "ajax_controller/add_delete_reading_list_post",
        data: a,
        success: function(c) {
            location.reload()
        }
    })
}

function load_more_posts() {
    $(".btn-load-more").prop("disabled", true);
    $("#load_posts_spinner").show();
    var c = parseInt($("#load_more_posts_last_id").val());
    var b = parseInt($("#load_more_posts_lang_id").val());
    var a = {
        load_more_posts_last_id: c,
        load_more_posts_lang_id: b
    };
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "home_controller/load_more_posts",
        data: a,
        success: function(e) {
            var d = JSON.parse(e);
            if (d.result == 1) {
                setTimeout(function() {
                    $("#last_posts_content").append(d.html_content);
                    $("#load_more_posts_last_id").val(d.last_id);
                    $("#load_posts_spinner").hide();
                    $(".btn-load-more").prop("disabled", false);
                    if (d.hide_button) {
                        $(".btn-load-more").hide()
                    }
                }, 300)
            } else {
                setTimeout(function() {
                    $("#load_more_posts_last_id").val(d.last_id);
                    $("#load_posts_spinner").hide();
                    $(".btn-load-more").hide()
                }, 300)
            }
        }
    })
}

function load_more_comments(f) {
    var e = parseInt($("#vr_comment_limit").val());
    var d = {
        post_id: f,
        limit: e,
    };
    d[csfr_token_name] = $.cookie(csfr_cookie_name);
    $("#load_comments_spinner").show();
    $.ajax({
        method: "POST",
        url: base_url + "home_controller/load_more_comments",
        data: d
    }).done(function(a) {
        setTimeout(function() {
            $("#load_comments_spinner").hide();
            $("#vr_comment_limit").val(e + 5);
            document.getElementById("comment-result").innerHTML = a
        }, 500)
    })
}
$(document).on("click", ".widget-popular-posts .btn-nav-tab", function() {
    var b = $(this).attr("data-date-type");
    var c = $(this).attr("data-lang-id");
    var a = {
        date_type: b,
        lang_id: c
    };
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "ajax_controller/get_popular_posts",
        data: a,
        success: function(e) {
            var d = JSON.parse(e);
            if (d.result == 1) {
                setTimeout(function() {
                    document.getElementById("tab_popular_posts_response").innerHTML = d.html_content
                }, 100)
            }
        }
    })
});
$(document).on("click", ".visual-color-box", function() {
    var a = $(this).attr("data-color");
    $(".visual-color-box").empty();
    $(this).html('<i class="icon-check"></i>');
    $("#input_user_site_color").val(a)
});

function hide_cookies_warning() {
    $(".cookies-warning").hide();
    var a = {};
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "home_controller/cookies_warning",
        data: a,
        success: function(b) {}
    })
}
$("#print_post").on("click", function() {
    $(".post-content .title, .post-content .post-meta, .post-content .post-image, .post-content .post-text").printThis({
        importCSS: true,
    })
});
$(document).ajaxStop(function() {
    function d(a) {
        $("#poll_" + a + " .question").hide();
        $("#poll_" + a + " .result").show()
    }

    function c(a) {
        $("#poll_" + a + " .result").hide();
        $("#poll_" + a + " .question").show()
    }
});
$(document).ready(function() {
    $(".validate_terms").submit(function(a) {
        if (!$(".checkbox_terms_conditions").is(":checked")) {
            a.preventDefault();
            $(".custom-checkbox .checkbox-icon").addClass("is-invalid")
        } else {
            $(".custom-checkbox .checkbox-icon").removeClass("is-invalid")
        }
    })
});
$(document).ready(function() {
    $(".gallery-post-buttons a").css("opacity", "1")
});
$(document).ready(function(b) {
    b(".image-popup-single").magnificPopup({
        type: "image",
        titleSrc: function(a) {
            return a.el.attr("title") + "<small></small>"
        },
        image: {
            verticalFit: true,
        },
        gallery: {
            enabled: false,
            navigateByImgClick: true,
            preload: [0, 1]
        },
        removalDelay: 100,
        fixedContentPos: true,
    })
});
$(document).ready(function() {
    $(".form-newsletter").submit(function(b) {
        b.preventDefault();
        var c = $(this).attr("id");
        var d = "#" + c + " .newsletter-input";
        var a = $(d).val().trim();
        if (a == "") {
            $(d).addClass("has-error");
            return false
        } else {
            $(d).removeClass("has-error")
        }
        var e = $(this).serializeArray();
        e.push({
            name: csfr_token_name,
            value: $.cookie(csfr_cookie_name)
        });
        $.ajax({
            url: base_url + "add-to-newsletter",
            type: "post",
            data: e,
            success: function(g) {
                var f = JSON.parse(g);
                if (f.result == 1) {
                    if (c == "form_newsletter_footer") {
                        document.getElementById("form_newsletter_response").innerHTML = f.response
                    } else {
                        document.getElementById("modal_newsletter_response").innerHTML = f.response
                    }
                    if (f.is_success == 1) {
                        $(d).val("")
                    }
                }
            }
        })
    })
});

function close_newsletter_popup() {
    var a = {};
    a[csfr_token_name] = $.cookie(csfr_cookie_name);
    $.ajax({
        type: "POST",
        url: base_url + "close-newsletter-popup",
        data: a
    })
}
$(function() {
    $(".post-text table").wrap('<div style="overflow-x:auto;"></div>')
});
$(document).ready(function() {
    $(".circle-loader").toggleClass("load-complete");
    $(".checkmark").toggle()
});



var flag = false;
    var fl2 = false;
    $(".gal.next").on("click", function(){
        
        //var val = $('.slick-slide.slick-active').index();
        var val = $('.slick-slide.slick-active').data("slick-index");
        var len = $('.gal_img_count:last').data("count");
        //$('button.gal.prev.slick-arrow').show();
        console.log('asd')
        $('#featured-slider1').slick('slickGoTo', val+1);
        if(val){
            flag = true;
             var c = val + 2;             
             if(len >= c){
                var url= window.location.pathname + '?image='+ c;
                window.history.pushState('', 'NewsDrum', url);
                callGa(c);
                }
            
        }else{
            if(flag != true){
                var url= window.location.pathname + '?image='+ 2;
                window.history.pushState('', 'NewsDrum', url);
                callGa(2);
            }else{                
                var url= window.location.pathname + '?image='+ 2;
                window.history.pushState('', 'NewsDrum', url);
                callGa(2);
            }
        }

        
    });
    $(".gal.prev").on("click", function(){
        //var val = $(this).index();
        var val = $('.slick-slide.slick-active').data("slick-index");
        var len = $('.gal_img_count:last').data("count");
        //$('button.gal.next.slick-arrow').show();
        $('#featured-slider1').slick('slickGoTo', val-1);
        if(val){
             if(len >= val){
                if(val == 1){
                     var url= window.location.pathname + '?image='+ val;
                     window.history.pushState('', 'NewsDrum', url);
                     callGa(val);
                     
                }else{
                var url= window.location.pathname + '?image='+ val;
                window.history.pushState('', 'NewsDrum', url);
                callGa(val);
                }
            }
        }else{
           var url= window.location.pathname + '?image='+ len;
           window.history.pushState('', 'NewsDrum', url);
           callGa(len);  
        }

    });

    function callGa(c){
        gtag('event', 'image View', {'event_category' : 'galleries','event_label' : 'image='+ c});
    }
    /* This Code for Next article load on scroll */
    const contentPosts = [];
    var actionElectionId = 0;
    var scrollPos = {pos:0,direction:""};
    function getCurrentPostID(){
        var id = window.location.href.split("?")[0].split("-").pop();
        return id;
    }
    function storeElem(){
        $("div[id^=topcontentElement_],div[id^=bottomcontentElement_]").each(function(){
            var elem = document.querySelector('#'+this.id);
            let post_id = this.id.split("_")[1];
            contentPosts.push({elem,post_id,offset: elem.getBoundingClientRect().top + window.scrollY});
        });
    }
    function changeURLOnScroll(){
        if(contentPosts.length){
            const visibEle = contentPosts.filter(t => {
                return isInViewport(t.elem,1);
            });
            if(visibEle.length && getCurrentPostID()!=visibEle[visibEle.length-1].post_id){
                var selectorCurrentPage = ".contentElement_"+visibEle[visibEle.length-1].post_id;
                //console.log(visibEle);
                console.log(visibEle[visibEle.length-1].post_id);
                //console.log(visibEle);
                goTo($(selectorCurrentPage+" .title").text(),$(selectorCurrentPage).data('posturl')); 
            }
        }
    }
    function goTo(title, url) {
        
        $("meta[property='og:url']").attr("content", url);
        $("meta[property='og:title']").attr("content", title);
        $("title").text(title);

        if ("undefined" !== typeof history.pushState) {
            history.pushState("state", title, url);
        }else {
            window.location.assign(url);
        }
        gtag('event', 'scroll');
        window.COMSCORE && window.COMSCORE.beacon({
            c1: "2",
            c2: "32441600",
            cs_ucfr: "1"
        });
        console.log("PageViews Hit======="+url);
    }
    var loadNextPostFlag = 0;
    function loadNextNewsItem(post_id){
        $.ajax({
            type: "GET",
            url: base_url + "post-detail/"+post_id,
            success: function(postHtml) {
                $("#content").append(postHtml);
                $(".nextPostPlaceholder").html("");
                /* const index = window.infiniteScrollUrls.indexOf(post_id);
                if (index > -1) { // only splice array when item is found
                    array.splice(index, 1); // 2nd parameter means remove one item only
                  } */
                /* var selectorCurrentPage = ".contentElement_"+post_id;
                goTo($(selectorCurrentPage+" .title").text(),$(selectorCurrentPage).data('posturl'));  
                setTimeout(function(){ 
                    setTimeout(function(){gtag('event', 'scroll');}, 1000);
                    loadNextPostFlag = 0 
                }, 5000);
                FB.XFBML.parse(); */
                setTimeout(function(){ loadNextPostFlag = 0;  }, 2000);
                storeElem();
            }
        });
    }
    function isInViewport(element,flag=0) {
        const rect = element.getBoundingClientRect();
        var innerHeight = (window.innerHeight || document.documentElement.clientHeight);
        var innerWidth = (window.innerWidth || document.documentElement.clientWidth);
        if(flag>0){
            var bottom = (rect.bottom-(innerHeight/2));
            /* if (rect.top > scrollPos.pos){
                scrollPos.direction="UP";
            }else{
                scrollPos.direction="DOWN";
            }
            scrollPos.pos = rect.top;
            console.log(flag+"===="+scrollPos.direction); */
        }else{
            var bottom = rect.bottom;
        }
        
        //console.log(rect.top+"======"+rect.left+"======"+bottom+"====="+rect.right+"====="+innerHeight+"======"+innerWidth);
        return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            bottom <= innerHeight &&
            rect.right <= innerWidth
        );
    }
    
    $(document).ready(function() {
        window.infiniteScrollUrls = window.infiniteScrollUrls || [];
        $(window).on("scroll", function() {
            var nextObj = $('.nextPostPlaceholder');
            var bottomElement = document.querySelector('.nextPostPlaceholder');
            if(nextObj.length){
                //console.log("Footer View Port scroll========"+isInViewport(bottomElement));
                changeURLOnScroll();
                if (loadNextPostFlag<=0 && isInViewport(bottomElement) && window.infiniteScrollUrls && window.infiniteScrollUrls.length) {
                    loadNextPostFlag++;
                    console.log("Action load========");
                    var nextID = window.infiniteScrollUrls.splice(0, 1);
                    var loaderHTML = '<div class="next-page-loader"><h2>Loading</h2></div>';
                    $(".nextPostPlaceholder").html(loaderHTML);
                    loadNextNewsItem(nextID);
                }else{
                    //changeURLOnScroll();
                    /* $("div[class^=contentElement_]").each(function(){
                        console.log("Other Article========"+isInViewport(document.querySelector('.'+$(this).attr("class"))));
                    }); */
                }
            }
        });
    });